This document is meant to gather thoughts about how to proceed with IDE-support for [ng-objects](https://www.fermentedshark.com/). The two options under consideration are:

1. Add `ng` support to WOLips
2. Write IDE support pretty much from scratch

I like Eclipse, but a majority of Java developers and especially young/new developers prefer IntelliJ or even VS Code. This means creating an Eclipse-only plugin (or extending/forking WOLips) makes little sense for a new framework, and supporting all three IDEs would be ideal.

## Isn't that a bit much?

Possibly not. Most logic could probably be in a common library shared by all three plugins, keeping IDE-specific logic to a minimum. The largest part of "IDE" support is probably the component template editor, i.e. an editor that provides validation, autocompletes, element API editing and other goodness in the spirit of the WOLips template editor.

A lot of this should be implementable as an [LSP server](https://en.wikipedia.org/wiki/Language_Server_Protocol) that could be referenced from either IDE-specific plugins or other editors that support interfacing with an LSP server). The [Parsley template parser](https://github.com/undur/Parsley) (our refactoring of the WOOgnl parser, also used in `ng`) can probably serve as a starting point to provide APIs for the required template parsing and environment awareness.


## Should an `ng` plugin support WO as well

Whether that's sensible depends on the amount of work involved. If a common API could be specified for both WO and `ng` to provide template info to the LSP; what elements are available, how their APIs look etc. it could be doable. But this would require some work since to my knowledge, WO doesn't have any built in capabilities to provide this information. WOlips relies on Eclipse APIs to locate element classes (along with using tag shortcuts defined in and provided by WOLips itself), it has it's own APIs to look at element bindings etc.

## Analysis of WOLips

However, to begin somewhere I've been going over WOLips's features, checking what it does and which of those features are actually required, specifically for someone that only uses WO as a web framework. We also assume the user is using maven as a build system, although preferably we don't want to require or support any specific build system at all.

This means I'm not counting anything EOF related, D2W related, Ant build related etc. Everything non-basic-WOF related is off the menu. I might address each of later, explaining _why_ I consider certain features to not be required.

So.

# 1. Functionality that should be included

## 1. The component template editor / Element API editor

Now, this is the real doozy, so still under construction ðŸ‘·ðŸš§

1. WO component template folders (folders ending with ".wo") get treated more or less as single files in the UI. Double clicking a ".wo" folder will open a split editor for both the contained .html and the .wod. Regarding this, not many people know that WO actually supports _not_ having a .wo folder, but you can also just have a single HTML-file as your component template, using inline tags for any dynamic elements. I vastly prefer this style, since I never write use .wod files - but this is still rarely used since WOLips doesn't really support single file templates.

* Parsing WO templates, validation etc.
* Autocompletion for element names (WOElement subclasses on the classpath), binding names (by parsing the .api XML files), valid keypaths for bindings (public fields and methods, matching the KVC conventions - or fixed values from the API) etc.
* API editor
* .woo editor (only used for DisplayGroups in WOLips so â€¦ bah)
* Outline view (bah â€¦ does anyone use that?)
* More stuff to come...


## 2. Creation of WO-specific files

WOLips provides quite a few templates for the creation of new files, projects etc. For a modern WO maven app that doesn't use EOF or D2W, I think the only one that matters is "WOComponent", which creates a new WOComponent subclass and the associated template files. Easy enough.

WOLips also creates the .api files used to specify the binding API of elements and components. This isn't provided as a specific "new file" template though, but automatically generated by the component template editor when you start fidgeting with a component's API. Including an API template might be nice though, since to my knowledge WOLips does't have a good way to create an API file for a non-component dynamic element. Not many people relly do that though and creating an API file by hand is easy, so I  should probably relax a little. I'm discussing new features and gold plating here :).


## 3. The WOLips server

A simple HTTP server that runs inside Eclipse, allowing you to invoke actions in Eclipse through URLs. The most common action is probably clicking a stack trace element on an exception page, which opens the corresponding Java file and navigates to the clicked line. Bears mentioning since it's actually quite useful/convenient and probably simple to implement in any IDE.

# 2. Features possibly/probably not required

## 1. Maintaining a build during development

WOLips does one thing that *might* be required. Whether it's *actually* required requires some investigation.

WOLips maintains a "fake bundle" in a "build" folder for the app to use during development to locate resources. The folder contains Info.plist (some configuration for WO), resources (bundle resources and component templates) and webserver resources. This "fake bundle" is set as the working directory for the running Java application.

I thought this was redundant by now and merely an artifact from the Ant days, but had forgotten that I always mindlessly point WO to this directory as a working directory since my WO Apps throw an error on launch without it. This morning, I decided to investigate the error, and turns out it's not in WO but Project Wonder - and disabling the failing logic there actually results in an apparently fine WO app running with seemingly nothing missing and locating resources from the project itself. So - I think that with a fix in Wonder, the "build" could become unneccessary. I just haven't looked into if and how that fix can be done.

If fixing this in Wonder turns out not to be a workable solution, I don't think it's hard to recreate WOLips's build, especially if focusing on a single project type, i.e. a simple maven WO app without any of the "additional frameworks". The instructions and configuration for how that "build" come from pattern files in a WO project's "woproject" folder. These files instruct WOLips and the WO maven plugin on what files to put where and which files to ignore when assembling a build product; files matching a certain pattern are resources, another one's a component template, these are webserver resources etc.).

This is still a hassle though (and an unneccessary one IMHO) so a Wonder fix would be vastly preferable. ERXLoader, where the error occurs on startup in Project Wonder if the build folder is missing, is a terrible mess anyway, and I've deleted most of it in the Wonder fork I use for everything. Deleting even more would be nice.

I'm probably going to investigate this further - and I'm switching to running my apps with the project itself as the working directory for now instead of the build folder (with the failing logic in ERXLoader/Wonder disabled) and see if I spot any potential problems.


## 2. WO-specific "Launch configurations"

Probably mostly redundant today. Was useful since it took care of generating a classpath, which was especially convenient for Ant projects. It's a little nice since it has a separate UI for setting WO-specific properties, and you can change the default properties for new applications. But if you're always running the same applications (which I think most current WO developers do) that becomes less important.

I haven't used this functionality in years (stopped using it since it can generate a broken classpath for maven projects). I prefer to start my WO applications as plain Java applications, passing any arguments via program arguments/VM Arguments. So; might be a "nice to have" but not a neccessity.

Note: This actually takes care of setting the working directory for the application as well, setting it to the WOLips build directory. This might not be required though, see #2.1.